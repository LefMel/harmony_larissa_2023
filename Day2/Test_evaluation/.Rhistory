theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 18, face = "bold"),
axis.title.y = element_text(size = 18, face = "bold"),
axis.text.x = element_text(size = 16),
axis.text.y = element_text(size = 16)
)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 18, face = "bold"),
axis.title.y = element_text(size = 18, face = "bold"),
axis.text.x = element_text(size = 16),
axis.text.y = element_text(size = 16)
)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.y = element_text(size = 18, face = "bold"),
axis.text.x = element_text(size = 16),
axis.text.y = element_text(size = 16)
)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 18, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 18, face = "bold"),
axis.title.y = element_text(size = 18, face = "bold"),
axis.text.y = element_text(size = 16)
)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...6)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 14, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
data$hazards...8
ggplot(data, aes(x=hazards...8)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 14, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=notifying_country)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data, aes(x=notifying_country)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=notifying_country)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Country", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=notifying_country)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Notifying Country", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=year)) +
geom_bar() +
labs(title = "Frequency of Biological Hazards", x = "Date", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
names(data)
data$year = substr(data$date,start=7, stop=10)
ggplot(data, aes(x=year)) +
geom_bar() +
labs(title = "Frequency of Biological Hazards", x = "Date", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
data$type
data$`Type of product`
ggplot(data, aes(x=hazards...5)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
data$`Type of product`
ggplot(data, aes(x=...5)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8, colour=as.factor(data$...5))) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8, colour=as.factor(...5))) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
# extra figures
data$Type_of_product = as.factor(data$..5)
ggplot(data, aes(x=hazards...8, colour=as.factor(...5))) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8, colour=Type_of_product)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
# extra figures
data$product = as.factor(data$..5)
# extra figures
data$product = as.factor(data$...5)
ggplot(data, aes(x=hazards...8, colour=product)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
data$Risk = as.factor(data$risk_decision)
ggplot(data, aes(x=hazards...8, colour=risk)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8, colour=Risk)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=product, colour=Risk)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=product, colour=Risk)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
names(data)
ggplot(data, aes(x=product, colour=year)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8, colour=product)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=product, colour=Risk)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=product, colour=year)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Type of product", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
library(readxl)
RASFF_window_results_Biological_bacteria <- read_excel("Downloads/RASFF_window_results_Biological_bacteria.xlsx")
View(RASFF_window_results_Biological_bacteria)
library(ggplot2)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
data = RASFF_window_results_Biological_bacteria
library(ggplot2)
ggplot(data, aes(x=risk_decision)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Category", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14, face="bold"),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
ggplot(data, aes(x=hazards...8)) +
geom_bar() +
labs(title = "Frequency of Categories", x = "Biological Hazard", y = "Frequency") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12),
plot.title = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"),
axis.title.y = element_text(size = 14, face = "bold"),
axis.text.y = element_text(size = 14)
)
getwd()
setwd("/Users/lefmel/Documents/Publications/Papatsiros - Multi disease")
list.files()
library(openxlsx)
draft <- read.xlsx("ARXEIO PRRSV SIV 18.05.2023.xlsx")
View(draft)
names(draft)
names <- c("Farm_ID", "Location", "SIV_Vac", "PRRS_Vac", "Age", "PRRSV", "PRRSV_dic", "PCV2", "SIV", "SIV_dic",  "App", "App_dic", "M.hyo", "M.hyo_dic", "PCR_PCV2", "PCR_PRRS")
data = draft
colnames(data) = names
View(data)
draft = draft[,-1]
data = draft
colnames(data) = names
View(data)
str(data)
hist(as.numeric(data$PRRSV))
hist(log(as.numeric(data$PRRSV)))
table(data$PCR_PRRS)
table(data$PCR_PCV2)
range(log(log(as.numeric(data$PRRSV))))
summary(as.numeric(data$PRRSV))
hist(log(as.numeric(data$PRRSV)+1))
range((log(as.numeric(data$PRRSV))))
range((log(as.numeric(data$PRRSV))+1))
log(as.numeric(data$PRRSV)+1)
range(log(as.numeric(data$PRRSV)+1))
summary(log(as.numeric(data$PRRSV)+1))
prrs = !is.na(data[,6])
prrs = data[!is.na(data[,6])]
prrs = data[!is.na(data[,6]),6]
prrs = as.numeric(prrs)
summary(prrs)
hist(prrs)
hist(log(prrs))
hist(log(prrs+1))
summary(log(prrs+1))
hist(log(prrs+1))
range(log(prrs+1))
(5.7 - 0)/300
library(runjags)
runjags.options(add.summary=TRUE)
?runjags.options
results <- run.jags("normal_model", data=list(Ab=log(prrs+1), N = 1409), monitor=c("se", "sp", "J", "P", "AUC"))
results <- run.jags("normal_model", data=list(Ab=log(prrs+1), N = 1409, alpha=c(1,1)), monitor=c("se", "sp", "J", "P", "AUC"))
runjags.options(force.summary=TRUE)
summary(results)
results <- run.jags("normal_model", data=list(Ab=log(prrs+1), N = 1409, alpha=c(1,1)), monitor=c("J", "P", "AUC"))
View(summary(results))
exp(0 + 0.02*117)
exp(0 + 0.02*117) - 1
tp_model <-
'model {
# Define likelihood distribution of the data
# JAGS Binomial distribution Arguments: ap, n
y ~ dbin(ap,n)
ap <- tp * Se + (1-tp)*(1-Sp)
# Specify prior distribution for parameters of interest
# Uniform (non-informative) prior distribution
tp ~ dbeta(1,1)
# Prior distributions for Se, Sp
Se ~ dbeta(100,9)
Sp ~ dbeta(100,9)
#data# n, y
#monitor# tp, Se, Sp
#inits# tp, Se, Sp
}
'
pop_1 = matrix(nrow=3,ncol=3)
rownames(pop_1) = c("Mantoux_Test_Pos", "Mantoux_Test_Neg", "Total")
colnames(pop_1) = c("Tine_Test_Pos", "Tine_Test_Neg", "Total")
pop_1[1,1] = 14
pop_1[1,2] = 4
pop_1[2,1] = 9
pop_1[2,2] = 528
#Total rows and columns
pop_1[1,3] = pop_1[1,1] + pop_1[1,2]
pop_1[2,3] = pop_1[2,1] + pop_1[2,2]
pop_1[3,1] = pop_1[1,1] + pop_1[2,1]
pop_1[3,2] = pop_1[1,2] + pop_1[2,2]
N_1 = sum(pop_1[1,1] + pop_1[1,2] + pop_1[2,1] + pop_1[2,2])
pop_1[3,3] = N_1
pop_1
pop_2 = matrix(nrow=3,ncol=3)
rownames(pop_2) = c("Mantoux_Test_Pos", "Mantoux_Test_Neg", "Total")
colnames(pop_2) = c("Tine_Test_Pos", "Tine_Test_Neg", "Total")
pop_2[1,1] = 887
pop_2[1,2] = 31
pop_2[2,1] = 37
pop_2[2,2] = 367
#Total rows and columns
pop_2[1,3] = pop_2[1,1] + pop_2[1,2]
pop_2[2,3] = pop_2[2,1] + pop_2[2,2]
pop_2[3,1] = pop_2[1,1] + pop_2[2,1]
pop_2[3,2] = pop_2[1,2] + pop_2[2,2]
N_2 = sum(pop_2[1,1] + pop_2[1,2] + pop_2[2,1] + pop_2[2,2])
pop_2[3,3] = N_2
pop_2
hw_definition <- c("model{
Population_1 ~ dmulti(prob_1, N_1)
Population_2 ~ dmulti(prob_2, N_2)
#Population_1
# Test1+ Test2+
prob_1[1] <- (prev[1] * ((se[1])*(se[2]))) + ((1-prev[1]) * ((1-sp[1])*(1-sp[2])))
# Test1+ Test2-
prob_1[2] <- (prev[1] * ((se[1])*(1-se[2]))) + ((1-prev[1]) * ((1-sp[1])*(sp[2])))
# Test1- Test2+
prob_1[3] <- (prev[1] * ((1-se[1])*(se[2]))) + ((1-prev[1]) * ((sp[1])*(1-sp[2])))
# Test1- Test2-
prob_1[4] <- (prev[1] * ((1-se[1])*(1-se[2]))) + ((1-prev[1]) * ((sp[1])*(sp[2])))
#Population_2
# Test1+ Test2+
prob_2[1] <- (prev[2] * ((se[1])*(se[2]))) + ((1-prev[2]) * ((1-sp[1])*(1-sp[2])))
# Test1+ Test2-
prob_2[2] <- (prev[2] * ((se[1])*(1-se[2]))) + ((1-prev[2]) * ((1-sp[1])*(sp[2])))
# Test1- Test2+
prob_2[3] <- (prev[2] * ((1-se[1])*(se[2]))) + ((1-prev[2]) * ((sp[1])*(1-sp[2])))
# Test1- Test2-
prob_2[4] <- (prev[2] * ((1-se[1])*(1-se[2]))) + ((1-prev[2]) * ((sp[1])*(sp[2])))
prev[1] ~ dbeta(1, 1)
prev[2] ~ dbeta(1, 1)
se[1] ~ dbeta(1, 1)T(1-sp[1], )
sp[1] ~ dbeta(1, 1)
se[2] ~ dbeta(1, 1)T(1-sp[2], )
sp[2] ~ dbeta(1, 1)
#data# Population_1, Population_2, N_1, N_2
#monitor# prev, prob_1, prob_2, se, sp
#inits# prev, se, sp
}
")
library('runjags')
Population_1 <- as.numeric(pop_1[1:2,1:2])
Population_2 <- as.numeric(pop_2[1:2,1:2])
prev <- list(chain1=c(0.05,0.99), chain2=c(0.95,0.05))
se <- list(chain1=c(0.5,0.99), chain2=c(0.99,0.5))
sp <- list(chain1=c(0.5,0.99), chain2=c(0.99,0.5))
results <- run.jags(hw_definition, n.chains=2)
library("runjags")
set.seed(2023-10-26)
# To collect temporary filenames:
cleanup <- character(0)
plot(results)
View(summary(results))
getwd()
setwd("/Users/lefmel/Documents/GitHub)
setwd("/Users/lefmel/Documents/GitHub)"
setwd("/Users/lefmel/Documents/GitHub")
setwd("/Users/lefmel/Documents/GitHub/harmony_larissa_2023/Day2")
setwd("/Users/lefmel/Documents/GitHub/harmony_larissa_2023/Day2/Test_evaluation")
pop_1 = matrix(nrow=3,ncol=3)
rownames(pop_1) = c("Mantoux_Test_Pos", "Mantoux_Test_Neg", "Total")
colnames(pop_1) = c("Tine_Test_Pos", "Tine_Test_Neg", "Total")
pop_1[1,1] = 14
pop_1[1,2] = 4
pop_1[2,1] = 9
pop_1[2,2] = 528
#Total rows and columns
pop_1[1,3] = pop_1[1,1] + pop_1[1,2]
pop_1[2,3] = pop_1[2,1] + pop_1[2,2]
pop_1[3,1] = pop_1[1,1] + pop_1[2,1]
pop_1[3,2] = pop_1[1,2] + pop_1[2,2]
N_1 = sum(pop_1[1,1] + pop_1[1,2] + pop_1[2,1] + pop_1[2,2])
pop_1[3,3] = N_1
pop_1
